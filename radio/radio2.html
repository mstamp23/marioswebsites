<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greek Radio Retro Deck</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Syne:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #121212; --panel: #1e1e1e; --accent: #e8a838;
            --display-bg: #1a2a1a; --display-text: #50ff50; --text: #f0ece3;
        }
        body { font-family: "Syne", sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        /* Dashboard */
        .radio-dashboard { background: var(--panel); width: 100%; max-width: 800px; padding: 20px; border-radius: 15px; border: 4px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px; position: sticky; top: 10px; z-index: 100; }
        .display-screen { background: var(--display-bg); border: 3px solid #000; padding: 15px; border-radius: 5px; height: 100px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; font-family: "Orbitron", sans-serif; color: var(--display-text); text-shadow: 0 0 10px rgba(80, 255, 80, 0.5); margin-bottom: 15px; }
        .display-cat { font-size: 0.8rem; text-transform: uppercase; margin-bottom: 5px; opacity: 0.8; }
        .display-name { font-size: 1.4rem; font-weight: bold; }
        .controls { display: flex; justify-content: center; gap: 20px; }
        
        /* Buttons */
        .btn { background: #333; border: 2px solid #444; color: white; padding: 10px 20px; cursor: pointer; border-radius: 5px; font-weight: bold; transition: 0.2s; }
        .btn:hover { background: #444; color: var(--accent); }
        .btn.active-cat { border-color: var(--accent); color: var(--accent); box-shadow: 0 0 10px rgba(232, 168, 56, 0.3); }

        /* Categories Bar */
        .categories-bar { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 30px; width: 100%; max-width: 1200px; }

        /* Station Grid */
        #grid-container { width: 100%; max-width: 1200px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }
        .card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; text-align: center; cursor: pointer; transition: 0.3s; font-size: 0.9rem; }
        .card:hover { background: rgba(255,255,255,0.1); transform: translateY(-3px); }
        .card.playing { border-color: var(--accent); background: rgba(232, 168, 56, 0.15); box-shadow: 0 0 15px rgba(232, 168, 56, 0.2); }
        
        kbd { background: #333; padding: 2px 4px; border-radius: 3px; font-size: 0.7rem; color: #888; }
    </style>
</head>
<body>

    <div class="radio-dashboard">
        <div class="display-screen">
            <div id="disp-cat" class="display-cat">SELECT A CATEGORY</div>
            <div id="disp-name" class="display-name">READY</div>
        </div>
        <div class="controls">
            <button class="btn" onclick="seek(-1)" title="Left Arrow Key">|<< <kbd>←</kbd></button>
            <button class="btn" id="play-pause" onclick="togglePlay()">STOP</button>
            <button class="btn" onclick="seek(1)" title="Right Arrow Key"><kbd>→</kbd> >>|</button>
        </div>
    </div>

    <div class="categories-bar" id="cat-bar"></div>

    <div id="grid-container">
        <div class="grid" id="main-grid"></div>
    </div>

    <audio id="player"></audio>

    <script src="stations_data.js"></script>

    <script>
        const stations = typeof radioData !== "undefined" ? radioData : [];
        let currentIdx = -1;
        let activeCategory = "";
        
        const player = document.getElementById("player");
        const dispCat = document.getElementById("disp-cat");
        const dispName = document.getElementById("disp-name");
        const mainGrid = document.getElementById("main-grid");
        const catBar = document.getElementById("cat-bar");

        function init() {
            if (stations.length === 0) {
                mainGrid.innerHTML = "<h2 style=\"color:red\">Error: Could not load stations_data.js</h2>";
                return;
            }

            // Create Category Buttons
            const cats = [...new Set(stations.map(s => s.category))];
            cats.forEach(cat => {
                const btn = document.createElement("button");
                btn.className = "btn";
                btn.innerText = cat;
                btn.onclick = () => filterByCategory(cat, btn);
                catBar.appendChild(btn);
            });

            // Default: load first category
            if(cats.length > 0) filterByCategory(cats[0], catBar.firstChild);
        }

        function filterByCategory(catName, btnElement) {
            activeCategory = catName;
            
            // UI Update: highlight button
            document.querySelectorAll(".categories-bar .btn").forEach(b => b.classList.remove("active-cat"));
            btnElement.classList.add("active-cat");

            // Filter and Render
            renderGrid(stations.filter(s => s.category === catName));
        }

        function renderGrid(filteredList) {
            mainGrid.innerHTML = "";
            filteredList.forEach(s => {
                const globalIndex = stations.indexOf(s);
                const card = document.createElement("div");
                card.className = "card";
                if(globalIndex === currentIdx) card.classList.add("playing");
                card.id = "station-" + globalIndex;
                card.innerHTML = `<div>${s.name}</div>`;
                card.onclick = () => playStation(globalIndex);
                mainGrid.appendChild(card);
            });
        }

        function playStation(index) {
            if(index < 0 || index >= stations.length) return;
            
            // Remove active class from previous
            document.querySelectorAll(".card").forEach(c => c.classList.remove("playing"));
            
            currentIdx = index;
            const s = stations[index];
            
            dispCat.innerText = s.category;
            dispName.innerText = s.name;
            
            // Add playing class to current card if it exists in current grid
            document.getElementById("station-"+index)?.classList.add("playing");

            player.src = s.streamer;
            player.play().catch(e => { dispName.innerText = "STREAM ERROR"; });
            document.getElementById("play-pause").innerText = "STOP";
        }

        function togglePlay() {
            if (player.paused) { player.play(); document.getElementById("play-pause").innerText = "STOP"; }
            else { player.pause(); document.getElementById("play-pause").innerText = "PLAY"; }
        }

        function seek(dir) {
            const sameCatStations = stations.filter(s => s.category === activeCategory);
            
            // If nothing playing in this category, start at 0 or end
            let currentInCatIdx = sameCatStations.findIndex(s => stations.indexOf(s) === currentIdx);
            
            let nextInCat = currentInCatIdx + dir;
            if (nextInCat < 0) nextInCat = sameCatStations.length - 1;
            if (nextInCat >= sameCatStations.length) nextInCat = 0;

            const nextStation = sameCatStations[nextInCat];
            playStation(stations.indexOf(nextStation));
        }

        // --- KEYBOARD SUPPORT ---
        document.addEventListener("keydown", (e) => {
            if (e.key === "ArrowRight") {
                seek(1);
            } else if (e.key === "ArrowLeft") {
                seek(-1);
            } else if (e.key === " ") { // Spacebar to toggle play
                e.preventDefault(); // Stop page scrolling
                togglePlay();
            }
        });

        init();
    </script>
</body>
</html>
